{"ast":null,"code":"import { resolve as e } from \"@thwack/resolve\";\n\nconst t = {\n  \"application/json\": \"json\",\n  \"multipart/form-data\": \"formData\",\n  \"*/*\": \"text\",\n  \"text/event-stream\": \"stream\"\n},\n      r = (_ref, _ref2) => {\n  let [e] = _ref;\n  let [t] = _ref2;\n  return e < t ? -1 : e > t ? 1 : 0;\n},\n      s = e => Object.entries(e).sort(r).map(_ref3 => {\n  let [e, t] = _ref3;\n  return `${encodeURIComponent(e)}=${encodeURIComponent(t)}`;\n}).join(\"&\"),\n      n = t => {\n  const {\n    url: r,\n    baseURL: n = r,\n    params: o,\n    resolver: a = e,\n    paramsSerializer: c = s\n  } = t,\n        i = a(r, n),\n        [u, p] = ((e, t) => {\n    const r = { ...t\n    };\n    return [e.split(\"/\").map(e => {\n      if (e.startsWith(\":\")) {\n        const t = e.substr(1),\n              s = r[t];\n        return delete r[t], encodeURIComponent(s);\n      }\n\n      return e;\n    }).join(\"/\"), r];\n  })(i, o);\n\n  return ((e, t) => {\n    const r = e.includes(\"?\") ? \"&\" : \"?\";\n    return `${e}${t ? r : \"\"}${t}`;\n  })(u, c(p));\n},\n      o = \"undefined\" != typeof Blob,\n      a = e => e >= 200 && e < 300,\n      c = {\n  arraybuffer: \"arrayBuffer\",\n  document: \"formData\"\n};\n\nclass i {\n  constructor(e, t) {\n    const {\n      status: r = 200,\n      statusText: s = \"Status \" + r,\n      data: n,\n      headers: o = {}\n    } = e;\n    this.status = r, this.statusText = s, this.ok = a(r), this.data = n, this.headers = \"function\" == typeof o.entries ? Object.fromEntries(o.entries()) : o, this.options = t, this.response = e;\n  }\n\n}\n\nclass u {\n  constructor(e, t) {\n    this.type = e, this.defaultPrevented = !1, this.propagationStopped = !1, this._payload = t;\n  }\n\n  preventDefault() {\n    this.defaultPrevented = !0;\n  }\n\n  stopPropagation() {\n    this.propagationStopped = !0;\n  }\n\n}\n\nclass p extends u {\n  constructor(e, t) {\n    super(e, t), Object.defineProperty(this, \"thwackResponse\", {\n      get() {\n        return this._payload;\n      }\n\n    });\n  }\n\n}\n\nclass l extends p {\n  constructor(e) {\n    super(\"data\", e);\n  }\n\n}\n\nclass h extends p {\n  constructor(e) {\n    super(\"error\", e);\n  }\n\n}\n\nclass d extends Error {\n  constructor(e) {\n    super(\"ThwackResponseError\"), this.message = \"Status \" + e.status, this.name = \"ThwackResponseError\", this.thwackResponse = e;\n  }\n\n}\n\nconst f = function (e) {\n  try {\n    const r = this;\n    if (!(e instanceof i)) throw new Error(\"Thwack: callback must return a ThwackResponse\");\n    return Promise.resolve(function (e) {\n      try {\n        const {\n          response: s,\n          options: n\n        } = e,\n              {\n          responseType: o,\n          responseParserMap: a\n        } = n,\n              i = e.headers[\"content-type\"],\n              u = (r = o || function () {\n          let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n          let r = arguments.length > 1 ? arguments[1] : undefined;\n          const [s] = e.split(\";\"),\n                n = s.trim(),\n                [o] = n.split(\"/\"),\n                a = { ...t,\n            ...r\n          };\n          return a[n] || a[o + \"/*\"] || a[\"*/*\"];\n        }(i, a), c[r] || r);\n        return Promise.resolve(\"stream\" === u ? s.body : s[u] ? s[u]() : e.data);\n      } catch (e) {\n        return Promise.reject(e);\n      }\n\n      var r;\n    }(e)).then(function (t) {\n      let s;\n\n      function n(t) {\n        if (s) return t;\n        const n = new h(e);\n        return Promise.resolve(r.dispatchEvent(n)).then(function (e) {\n          const {\n            defaultPrevented: t\n          } = n;\n          if (t && e.ok) return f.call(r, e);\n          if (!(e instanceof i)) throw new Error(\"Thwack: callback must return a ThwackResponse\");\n          throw new d(e);\n        });\n      }\n\n      e.data = t;\n\n      const {\n        validateStatus: o = a\n      } = e.options,\n            c = function () {\n        if (o(e.status)) {\n          const t = new l(e);\n          return Promise.resolve(r.dispatchEvent(t)).then(function (e) {\n            const {\n              defaultPrevented: n\n            } = t;\n            return n && !e.ok ? (s = 1, f.call(r, e)) : (s = 1, e);\n          });\n        }\n      }();\n\n      return c && c.then ? c.then(n) : n(c);\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\n\nclass m extends p {\n  constructor(e) {\n    super(\"response\", e);\n  }\n\n}\n\nclass v extends u {\n  constructor(e) {\n    super(\"request\", e), Object.defineProperty(this, \"options\", {\n      get() {\n        return this._payload;\n      }\n\n    });\n  }\n\n}\n\nconst w = function () {\n  let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return Object.keys({ ...e,\n    ...t\n  }).reduce((r, s) => {\n    const n = null != t[s] ? t[s] : e[s];\n    return { ...r,\n      [s]: (o = n, \"[object Object]\" === Object.prototype.toString.call(o) ? w(e[s], t[s]) : n)\n    };\n    var o;\n  }, {});\n},\n      y = (e, t) => w(e.defaults, t),\n      P = function (e) {\n  try {\n    const t = this,\n          { ...r\n    } = y(t, e),\n          s = new v(r);\n    return Promise.resolve(t.dispatchEvent(s)).then(function (e) {\n      const {\n        defaultPrevented: r\n      } = s;\n      if (r) return f.call(t, e);\n      const a = e;\n      return Promise.resolve(function (e) {\n        try {\n          const {\n            url: t,\n            baseURL: r,\n            fetch: s,\n            data: a,\n            headers: c,\n            ...i\n          } = e;\n          if (!s) throw new Error(\"Thwack: Invalid options object during request. Check your event callbacks.\");\n          a && !c[\"content-type\"] && (c[\"content-type\"] = (e => o && e instanceof Blob ? e.type : \"application/json\")(a));\n          const u = a && \"application/json\" === c[\"content-type\"] ? JSON.stringify(a) : a,\n                p = n({ ...e,\n            url: t,\n            baseURL: r\n          }),\n                l = { ...(0 !== Object.keys(c).length && {\n              headers: c\n            }),\n            ...(!!u && {\n              body: u,\n              method: \"POST\"\n            }),\n            ...i\n          };\n          return Promise.resolve(s(p, l));\n        } catch (e) {\n          return Promise.reject(e);\n        }\n      }(a)).then(function (e) {\n        const r = new m(new i(e, a));\n        return Promise.resolve(t.dispatchEvent(r)).then(function (e) {\n          return f.call(t, e);\n        });\n      });\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n},\n      b = e => e.length > 1 ? { ...e[1],\n  url: e[0]\n} : e[0],\n      E = function (e, t) {\n  const r = function () {\n    return r.request(b([].slice.call(arguments)));\n  };\n\n  return r.defaults = e, r.request = P.bind(r), [\"GET\", \"DELETE\", \"HEAD\"].forEach(e => {\n    const t = e.toLowerCase();\n\n    r[t] = (t, s) => r.request({ ...s,\n      method: e,\n      url: t\n    });\n  }), [\"PUT\", \"POST\", \"PATCH\"].forEach(e => {\n    const t = e.toLowerCase();\n\n    r[t] = (t, s, n) => r.request({ ...n,\n      method: e,\n      url: t,\n      data: s\n    });\n  }), r.getUri = e => {\n    const t = y(r, e);\n    return n(t);\n  }, r.create = e => {\n    const t = y(r, e);\n    return E(t, r);\n  }, ((e, t) => {\n    let r = 0;\n    const s = {\n      request: [],\n      response: [],\n      data: [],\n      error: []\n    };\n    e.addEventListener = (e, t) => {\n      s[e].push(t);\n    }, e.removeEventListener = (e, t) => {\n      s[e] = s[e].filter(e => e !== t);\n    }, e.dispatchEvent = e => s[e.type].reduce((t, s) => t.then(() => {\n      if (r += 1, r >= 5) throw new Error(\"Thwack: maximum request depth reached\");\n      return e.propagationStopped ? void 0 : s(e);\n    }).finally(() => {\n      r -= 1;\n    }).then(t => {\n      void 0 !== t && (e._payload = t);\n    }), t ? t.dispatchEvent(e) : Promise.resolve()).then(() => e._payload);\n  })(r, t), r;\n},\n      k = E({\n  maxDepth: 5,\n  params: {},\n  headers: {\n    accept: \"application/json, text/plain, */*\"\n  },\n  buildURL: \"complete\"\n});\n\nif (k.ThwackResponseError = d, k.ThwackResponse = i, k.all = e => Promise.all(e), k.spread = e => t => e(...t), \"undefined\" != typeof window) {\n  const {\n    fetch: e,\n    location: t\n  } = window;\n\n  if (k.defaults.fetch = e, t) {\n    const {\n      origin: e,\n      pathname: r\n    } = t;\n    k.defaults.baseURL = `${e}${r}`;\n  }\n}\n\nexport default k;","map":{"version":3,"mappings":";;MAYaA,IAAmB;AAC9BC,sBAAoB,MADU;AAE9BC,yBAAuB,UAFO;AAG9BC,SAAO,MAHuB;AAI9BC,uBAAqB;AAJS;MCX1BC,IAAc;AAAA,OAAEC,CAAF;AAAA,MAAEA,CAAKC,CAALD,CAAF;AAAA,SACdA,IAAIC,CAAJD,GAAIC,CACE,CADND,GAGAA,IAAIC,CAAJD,GAAIC,CAAJD,GAAIC,CAJU;AAAA;MCCPC,IAA0BC,KACrCC,OAAOC,OAAPD,CAAeD,CAAfC,EACGE,IADHF,CACQL,CADRK,EAEGG,GAFHH,CAGI;AAAA,OAAEI,CAAF,EAAOC,CAAP;AAAA,SACG,GAAEC,mBAAmBF,CAAnBE,CAAmBF,IAAQE,mBAAmBD,CAAnBC,CAAmBD,EADnD;AAAA,CAHJL,EAMGO,IANHP,CAMQ,GANRA;MCEIQ,IAAYC;AAChB;AAAMC,SACJA,CADF;AAAMC,aAEJA,IAAUD,CAFZ;AAAMX,YAGJA,CAHF;AAAMa,cAIJA,IAAWC,CAJb;AAAMC,sBAKJA,IAAmBhB;AALrB,MAMIW,CANJ;AAAA,QASMM,IAAcH,EAASF,CAATE,EAAcD,CAAdC,CATpB;AAAA,QASkCD,CAG3BK,CAH2BL,EAGlBM,CAHkBN,ICfE,EAACO,CAAD,EAAOnB,CAAP,KAAOA;AAE3C,UAAMkB,IAAkB,KAAKlB;AAAL,KAAxB;AAcA,WAAO,CAbSmB,EACbC,KADaD,CACP,GADOA,EAEbf,GAFae,CAERE;AACJ,UAAIA,EAAQC,UAARD,CAAmB,GAAnBA,CAAJ,EAA6B;AAC3B,cAAMhB,IAAMgB,EAAQE,MAARF,CAAe,CAAfA,CAAZ;AAAA,cACMf,IAAQY,EAAgBb,CAAhBa,CADd;AAGA,sBADOA,EAAgBb,CAAhBa,CACP,EAAOX,mBAAmBD,CAAnBC,CAAP;AAEF;;AAAA,aAAOc,CAAP;AAAOA,KATKF,EAWbX,IAXaW,CAWR,GAXQA,CAaT,EAAUD,CAAV,CAAP;AAAiBA,GAhBmB,EDmBlCF,CCnBkC,EDoBlChB,CCpBkC,CDMpC;;AAmBA,SEzBiB,EAACW,CAAD,EAAMa,CAAN,KAAMA;AACvB,UAAMC,IAAad,EAAIe,QAAJf,CAAa,GAAbA,IAAoB,GAApBA,GAA0B,GAA7C;AACA,WAAQ,GAAEA,IAAMa,IAASC,CAATD,GAAsB,KAAKA,GAA3C;AAA2CA,GAF1B,EFyBCP,CEzBD,EFwBFF,EAAiBG,CAAjBH,CExBE,CFyBjB;AADgCG;MGpB5BS,IAAkC,sBAATC;MCJlBC,IAAyBC,KAAWA,KAAU,GAAVA,IAAiBA,IAAS;MCGrEC,IAAY;AAChBC,eAAa,aADG;AAEhBC,YAAU;AAFM;;AAEN,MCHSC,CDGT,CCHSA;AACnBC,cAAYC,CAAZD,EAAsBzB,CAAtByB,EAAsBzB;AACpB;AAAMoB,cACJA,IAAS,GADX;AAAMO,kBAEJA,IAAc,YAASP,CAFzB;AAAMQ,YAGJA,CAHF;AAAMC,eAIJA,IAAU;AAJZ,QAKIH,CALJ;AAMAI,SAAKV,MAALU,GAAcV,CAAdU,EACAA,KAAKH,UAALG,GAAkBH,CADlBG,EAEAA,KAAKC,EAALD,GAAUX,EAAsBC,CAAtBD,CAFVW,EAGAA,KAAKF,IAALE,GAAYF,CAHZE,EAIAA,KAAKD,OAALC,GAC6B,qBAApBD,EAAQrC,OAAY,GACvBD,OAAOyC,WAAPzC,CAAmBsC,EAAQrC,OAARqC,EAAnBtC,CADuB,GAEvBsC,CAPNC,EAQAA,KAAK9B,OAAL8B,GAAe9B,CARf8B,EASAA,KAAKJ,QAALI,GAAgBJ,CAThBI;AASgBJ;;AAjBCF;;AAiBDE,MClBCO,CDkBDP,CClBCO;AACnBR,cAAYS,CAAZT,EAAkBU,CAAlBV,EAAkBU;AAChBL,SAAKI,IAALJ,GAAYI,CAAZJ,EACAA,KAAKM,gBAALN,GAAKM,CAAmB,CADxBN,EAEAA,KAAKO,kBAALP,GAAKO,CAAqB,CAF1BP,EAGAA,KAAKQ,QAALR,GAAgBK,CAHhBL;AAMFS;;AAAAA;AACET,SAAKM,gBAALN,GAAKM,CAAmB,CAAxBN;AAGFU;;AAAAA;AACEV,SAAKO,kBAALP,GAAKO,CAAqB,CAA1BP;AAA0B;;AAbTG;;AAaS,MCZTQ,CDYS,SCZuBR,CDYvB,CCZuBA;AACnDR,cAAYS,CAAZT,EAAkBiB,CAAlBjB,EAAkBiB;AAChBC,UAAMT,CAANS,EAAYD,CAAZC,GAEApD,OAAOqD,cAAPrD,CAAsBuC,IAAtBvC,EAA4B,gBAA5BA,EAA8C;AAC5CsD;AACE,oBAAYP,QAAZ;AAAYA;;AAF8B,KAA9C/C,CAFAoD;AAIgBL;;AANiCL;;AAMjCK,MCNCQ,CDMDR,SCNyBG,CDMzBH,CCNyBG;AAC3ChB,cAAYiB,CAAZjB,EAAYiB;AACVC,UAAM,MAANA,EAAcD,CAAdC;AAAcD;;AAF2BD;;AAE3BC,MCFGK,CDEHL,SCF4BD,CDE5BC,CCF4BD;AAC5ChB,cAAYiB,CAAZjB,EAAYiB;AACVC,UAAM,OAANA,EAAeD,CAAfC;AAAeD;;AAF2BD;;ACA9C,MAAMO,CAAN,SAAkCC,KAAlC,CAAkCA;AAChCxB,cAAYiB,CAAZjB,EAAYiB;AACVC,UAJwB,qBAIxBA,GACAb,KAAKoB,OAALpB,GAAgB,YAASY,EAAetB,MADxCuB,EAEAb,KAAKqB,IAALrB,GANwB,qBAIxBa,EAGAb,KAAKY,cAALZ,GAAsBY,CAHtBC;AAGsBD;;AALQO;;AAKRP,MC6BpBU,cAAiCV,CAAjCU,EAAiCV;AAAAA;AAAAA,cAabZ,IAbaY;AACrC,UAAMA,aAA0BlB,CAAhC,GACE,UAAUyB,KAAV,CAAgB,+CAAhB;AAFmD,qCA3BtBP,CA2BsB,EA3BtBA;AAAAA;AAC/B;AAAMhB,oBAAEA,CAAR;AAAM1B,mBAAYA;AAAlB,YAA8B0C,CAA9B;AAAA,cAA8BA;AAOxBW,wBAAEA,CAPsBX;AAOxBY,6BAAgBA;AAPQZ,YAOc1C,CAP5C;AAAA,cAQMuD,IAAoBb,EAAeb,OAAfa,CfjBA,ceiBAA,CAR1B;AAAA,cAWMc,KPbcC,IOYlBJ,KClBkB,YAAyBK;AAAAA,cAAxBH,CAAwBG,uEAAJ,EAAIA;AAAAA;AAG7C,iBAAOC,CAAP,IAAsBJ,EAAkB7C,KAAlB6C,CAAwB,GAAxBA,CAAtB;AAAA,gBACMK,IAAqBD,EAAYE,IAAZF,EAD3B;AAAA,gBACuCE,CAIhCC,CAJgCD,IAIZD,EAAmBlD,KAAnBkD,CAAyB,GAAzBA,CAL3B;AAAA,gBAMMG,IAAkB,KAAKlF,CAAL;AAAKA,eAAqB6E;AAA1B,WANxB;AAaA,iBAJEK,EAAgBH,CAAhBG,KACAA,EAAmBD,IAAF,IAAjBC,CADAA,IAEAA,EAAgB,KAAhBA,CAEF;AAFkB,SAdE,CDkBYR,CClBZ,EDkB+BD,CClB/B,CRMAG,EACpBpC,EAAUoC,CAAVpC,KAAiCoC,COY3BD,CAXN;AAaA,+BAAiC,aAA7BA,CAA6B,GACxB9B,EAASsC,IADe,GAI7BtC,EAAS8B,CAAT9B,IACKA,EAAS8B,CAAT9B,GADLA,GAKGgB,EAAed,IATtB;AASsBA,OAvBSc,CAuBTd;AAAAA;APxBF6B;;AAAAA;AOiCQQ,KALyB,CAKPvB,CALO,GAKPA,IALO,CAKPA;AAAAA;;AAAAA;AAAAA;AAiB9C,cAAMwB,IAAa,IAAInB,CAAJ,CAAqBL,CAArB,CAAnB;AAtBqD,+BAuB/ByB,EAAKC,aAALD,CAAmBD,CAAnBC,CAvB+B,EAuBZD,IAvBY,CAuBZA,UAAnC/B,CAAmC+B,EAAnC/B;AACN;AAAMC,8BAAEA;AAAR,cAA6B8B,CAA7B;AACA,cAAI9B,KAAoBD,EAAQJ,EAAhC,EACE,OAAOqB,EAAeiB,IAAfjB,CAAeiB,CAAfjB,EAA0BjB,CAA1BiB,CAAP;AAGF,gBAAMjB,aAAmBX,CAAzB,GACE,UAAUyB,KAAV,CAAgB,+CAAhB;AAGF,oBAAUD,CAAV,CAA8Bb,CAA9B;AAA8BA,SAjCuB;AAKrDO;;AAAAA,QAAed,IAAfc,GAAed,CAAfc;;AAEA;AAAM4B,wBAAEA,IAAiBnD;AAAzB,UAAmDuB,EAAe1C,OAAlE;AAAA,YAAkEA;AAAAA,YAG9DsE,EAAe5B,EAAetB,MAA9BkD,CAH8DtE,EAGhCoB;AAEhC,gBAAMmD,IAAY,IAAIzB,CAAJ,CAAoBJ,CAApB,CAAlB;AAZmD,iCAa7ByB,EAAKC,aAALD,CAAmBI,CAAnBJ,CAb6B,EAaVI,IAbU,CAaVA,UAAnCpC,CAAmCoC,EAAnCpC;AACN;AAAMC,gCAAEA;AAAR,gBAA6BmC,CAA7B;AACA,mBAAInC,MAAqBD,EAAQJ,EAA7BK,IAA6BL,OACxBqB,EAAeiB,IAAfjB,CAAeiB,CAAfjB,EAA0BjB,CAA1BiB,CADLhB,KAf+CoC,OAkB5CrC,CAHHC,CAAJ;AAGOD,WAlB4C;AAkB5CA;AAAAA,OAXyDnC,EAAlE;;AAWSmC;AAAAA,KAlB4C;AAAnC,GAAmBO,CAAnB;AAAA;AAAA;AAAA,CD7BMA;;AC6BN,MElCC+B,CFkCD,SElC6BhC,CFkC7B,CElC6BA;AAC/ChB,cAAYiB,CAAZjB,EAAYiB;AACVC,UAAM,UAANA,EAAkBD,CAAlBC;AAAkBD;;AAF2BD;;AAE3BC,MCFDgC,CDEChC,SCF0BT,CDE1BS,CCF0BT;AAC9CR,cAAYzB,CAAZyB,EAAYzB;AACV2C,UAAM,SAANA,EAAiB3C,CAAjB2C,GAEApD,OAAOqD,cAAPrD,CAAsBuC,IAAtBvC,EAA4B,SAA5BA,EAAuC;AACrCsD;AACE,oBAAYP,QAAZ;AAAYA;;AAFuB,KAAvC/C,CAFAoD;AAIgBL;;AAN4BL;;ACFhD,MAGM0C,IAAoB;AAAA,MAACC,CAAD,uEAAiB,EAAjB;AAAA,MAAqB5E,CAArB,uEAA+B,EAA/B;AAAA,SACRT,OAAOsF,IAAPtF,CAAY,KACvBqF,CADuB;AACvBA,OACA5E;AAFuB,GAAZT,EAKDuF,MALCvF,CAKM,CAACwF,CAAD,EAAWpF,CAAX,KAAWA;AAG/B,UAAMC,IAAwB,QAAhBI,EAAQL,CAARK,CAAgB,GAAOA,EAAQL,CAARK,CAAP,GAAsB4E,EAAcjF,CAAdiF,CAApD;AAEA,WAAO,KACFG,CADE;AAELC,OAACrF,CAADqF,IAhBYC,IAgBIrF,CAhBJqF,EACwB,sBAAxC1F,OAAO2F,SAAP3F,CAAiB4F,QAAjB5F,CAA0B8E,IAA1B9E,CAA+B0F,CAA/B1F,CAAwC,GAgBhCoF,EAAkBC,EAAcjF,CAAdiF,CAAlBD,EAAsC3E,EAAQL,CAARK,CAAtC2E,CAhBgC,GAiBhC/E,CAFJoF;AAFK,KAAP;AAdcC;AAAAA,GAIA1F,EAgBb,EAhBaA,CADQ;AAAA,CAH1B;AAAA,MCEM6F,IAAiB,CAACC,CAAD,EAAWrF,CAAX,KACrB2E,EAAkBU,EAASC,QAA3BX,EAAqC3E,CAArC2E,CDHF;AAAA,MEOMY,cAA0BC,CAA1BD,EAA0BC;AAAAA;AAAAA,cAU0B1D,IAV1B0D;AAAAA,UAU0B1D,KAAnC2D;AAAmC3D,QAAfsD,KAAqBI,CAArBJ,CAVXI;AAAAA,UAexBE,IAAe,IAAIhB,CAAJ,CAAuBe,CAAvB,CAfSD;AAAgB,2BAgBxBrB,EAAKC,aAALD,CAAmBuB,CAAnBvB,CAhBwB,EAgBLuB,IAhBK,CAgBLA,UAAnCvD,CAAmCuD,EAAnCvD;AACN;AAAMC,0BAAEA;AAAR,UAA6BsD,CAA7B;AACA,UAAItD,CAAJ,EAEE,OAAOgB,EAAeiB,IAAfjB,CAAeiB,CAAfjB,EAA0BjB,CAA1BiB,CAAP;AAIF,YAAMpD,IAAUmC,CAAhB;AAxB8C,uCCHhBnC,CDGgB,ECHhBA;AAAAA;AAC9B;AAAMC,iBACJA,CADF;AAAMC,qBAEJA,CAFF;AAAMyF,mBAGJA,CAHF;AAAM/D,kBAIJA,CAJF;AAAMC,qBAKJA,CALF;AAKEA,eAKG+D;AAVL,cAWI5F,CAXJ;AAaA,eAAK2F,CAAL,EACE,UAAU1C,KAAV,CACE,4EADF;AAMErB,gBAASC,EtBxBa,csBwBbA,CAATD,KACFC,EtBzBwB,csByBxBA,IhBlBwBD,MAC1BX,KAAmBW,aAAgBV,IAAnCD,GAA0CW,EAAKM,IAA/CjB,GNT8B,kBMQJW,EgBkBmBA,ChBlBnBA,CgBiBtBA;AAGJ,gBAAMoC,IACJpC,KtB7B4B,uBsB6BpBC,EtB5BgB,csB4BhBA,CAARD,GACIiE,KAAKC,SAALD,CAAejE,CAAfiE,CADJjE,GAEIA,CAHN;AAAA,gBAKMmE,IAAWhG,EAAS,KAAKC,CAAL;AAAcC,kBAAd;AAAmBC;AAAnB,WAATH,CALjB;AAAA,gBAOMiG,IAAe,MACiB,MAAhCzG,OAAOsF,IAAPtF,CAAYsC,CAAZtC,EAAqB0G,MAAW,IAAK;AAAEpE;AAAF,aADtB;AACwBA,kBACrCmC,CADqCnC,IAC7B;AAAEmC,qBAAF;AAAQkC,sBAAQ;AAAhB,aAD6BrE,CADxB;AAEW,eAC3B+D;AAHgB,WAPrB;AAaA,iCAAOD,EAAMI,CAANJ,EAAgBK,CAAhBL,CAAP;AArCW,SAAmB3F,CAAnB;AAAA;AAAA;AD4BYmG,OAzBuB,CAyBfnG,CAzBe,GAyBfA,IAzBe,CAyBfA,UAAzB0B,CAAyB1B,EAAzB0B;AACN,cAAM0E,IAAgB,IAAI3B,CAAJ,CACpB,IAAIjD,CAAJ,CAAmBE,CAAnB,EAA6B1B,CAA7B,CADoB,CAAtB;AA1B8C,+BAgCPmE,EAAKC,aAALD,CAAmBiC,CAAnBjC,CAhCO,EAgCYiC,IAhCZ,CAgCYA;AAA1D,iBAAOhD,EAAeiB,IAAfjB,CAAeiB,CAAfjB,EAAeiB,CAAfjB,CAAP;AAAsBiB,SAhCwB;AAgCxBA,OAhCwB;AAgCxBA,KAhCwB;AAAnC,GAAmBmB,CAAnB;AAAA;AAAA;AAAA,CFPb;AAAA,MIAMa,IAA0BC,KAC9BA,EAAKL,MAALK,GAAc,CAAdA,GACI,KAAKA,EAAK,CAALA,CAAL;AAAcrG,OAAKqG,EAAK,CAALA;AAAnB,CADJA,GAEIA,EAAK,CAALA,CJHN;AAAA,MKMaC,IAAe,UAAUjB,CAAV,EAAoBkB,CAApB,EAAoBA;AAG9C,QAAMnB,IAAW;AAAA,WAAaA,EAASE,OAATF,CAAiBgB,2BAAjBhB,CAAb;AAA8BgB,GAA/C;;AA+BA,SA7BAhB,EAASC,QAATD,GAAoBC,CAApBD,EAEAA,EAASE,OAATF,GAAmBE,EAAQkB,IAARlB,CAAaF,CAAbE,CAFnBF,EAKA,CAAC,KAAD,EAAQ,QAAR,EAAkB,MAAlB,EAA0BqB,OAA1B,CAAmCR;AACjC,UAAMS,IAAYT,EAAOU,WAAPV,EAAlB;;AACAb,MAASsB,CAATtB,IAAsB,CAACpF,CAAD,EAAMD,CAAN,KACpBqF,EAASE,OAATF,CAAiB,KAAKrF,CAAL;AAAckG,eAAd;AAAsBjG;AAAtB,KAAjBoF,CADFA;AACyCpF,GAH3C,CALAoF,EAWA,CAAC,KAAD,EAAQ,MAAR,EAAgB,OAAhB,EAAyBqB,OAAzB,CAAkCR;AAChC,UAAMS,IAAYT,EAAOU,WAAPV,EAAlB;;AACAb,MAASsB,CAATtB,IAAsB,CAACpF,CAAD,EAAM2B,CAAN,EAAY5B,CAAZ,KACpBqF,EAASE,OAATF,CAAiB,KAAKrF,CAAL;AAAckG,eAAd;AAAsBjG,YAAtB;AAA2B2B;AAA3B,KAAjByD,CADFA;AAC8CzD,GAHhD,CAXAyD,EAiBAA,EAASwB,MAATxB,GAAmBrF;AACjB,UAAMyF,IAAkBL,EAAeC,CAAfD,EAAyBpF,CAAzBoF,CAAxB;AACA,WAAOrF,EAAS0F,CAAT1F,CAAP;AAAgB0F,GAnBlBJ,EAsBAA,EAASyB,MAATzB,GAAmBrF;AACjB,UAAM4E,IAAgBQ,EAAeC,CAAfD,EAAyBpF,CAAzBoF,CAAtB;AACA,WAAOmB,EAAa3B,CAAb2B,EAA4BlB,CAA5BkB,CAAP;AAAmClB,GAxBrCA,ECToB,EAACA,CAAD,EAAWmB,CAAX,KAAWA;AAE/B,QAAIO,IAAQ,CAAZ;AACA,UAAMC,IAAY;AAChBzB,eAAS,EADO;AAEhB7D,gBAAU,EAFM;AAGhBE,YAAM,EAHU;AAIhBqF,aAAO;AAJS,KAAlB;AAOA5B,MAAS6B,gBAAT7B,GAA4B,CAACnD,CAAD,EAAOiF,CAAP,KAAOA;AACjCH,QAAU9E,CAAV8E,EAAgBI,IAAhBJ,CAAqBG,CAArBH;AAAqBG,KADvB9B,EAIAA,EAASgC,mBAAThC,GAA+B,CAACnD,CAAD,EAAOiF,CAAP,KAAOA;AACpCH,QAAU9E,CAAV8E,IAAkBA,EAAU9E,CAAV8E,EAAgBM,MAAhBN,CACfO,KAAaA,MAAaJ,CADXH,CAAlBA;AAC6BG,KAN/B9B,EAUAA,EAASjB,aAATiB,GAA0BmC,KACxBR,EAAUQ,EAAMtF,IAAhB8E,EACGlC,MADHkC,CAEI,CAACS,CAAD,EAAUF,CAAV,KACEE,EAEGC,IAFHD,CAKI;AAEE,UADAV,KAAS,CAATA,EACIA,KAAS,CAAb,EACE,UAAU9D,KAAV,CAAgB,uCAAhB;AAEF,aAAOuE,EAAMnF,kBAANmF,GAAMnF,KAAqBsF,CAA3BH,GAAuCD,EAASC,CAATD,CAA9C;AAAuDC,KAV7DC,EAaGG,OAbHH,CAaW;AACPV,WAAS,CAATA;AAAS,KAdbU,EAkBGC,IAlBHD,CAkBStF;AAAAA,WACWwF,CADXxF,KACDA,CADCA,KAEHqF,EAAMlF,QAANkF,GAAiBrF,CAFdA;AAEcA,KApBvBsF,CAHNT,EA2BIR,IAASA,EAAOpC,aAAPoC,CAAqBgB,CAArBhB,CAATA,GAAuCqB,QAAQzH,OAARyH,EA3B3Cb,EA8BGU,IA9BHV,CA8BQ,MAAMQ,EAAMlF,QA9BpB0E,CAXF3B;AAyCsB/C,GAnDF,EDoCb+C,CCpCa,EDoCHmB,CCpCG,CDSpBnB,EA6BOA,CAAP;AAAOA,CLxCT;AAAA,MOMMyC,IAAevB,E1BHS;AAC5BwB,YAAU,CADkB;AAE5BzI,UAAQ,EAFoB;AAG5BuC,WAAS;AACPmG,YAAS;AADF,GAHmB;AAM5BC,YAAU;AANkB,C0BGT1B,CPNrB;;AQGA,IDMAuB,EAAa9E,mBAAb8E,GAAmC9E,CAAnC8E,EACAA,EAAatG,cAAbsG,GAA8BtG,CAD9BsG,EAEAA,EAAaI,GAAbJ,GAAoBK,KAAaN,QAAQK,GAARL,CAAYM,CAAZN,CAFjCC,EAGAA,EAAaM,MAAbN,GAAuBX,KAAckB,KAAYlB,KAAYkB,CAAZlB,CAHjDW,ECNsB,sBAAXQ,MAAX,EAAmC;AACjC;AAAM3C,WAAEA,CAAR;AAAM4C,cAASA;AAAf,MAA4BD,MAA5B;;AAIA,MAHAE,EAAKlD,QAALkD,CAAc7C,KAAd6C,GAAsB7C,CAAtB6C,EAGID,CAAJ,EAAc;AACZ;AAAME,cAAEA,CAAR;AAAMC,gBAAUA;AAAhB,QAA6BH,CAA7B;AACAC,MAAKlD,QAALkD,CAActI,OAAdsI,GAAyB,GAAEC,IAASC,GAApCF;AAAoCE;AAAAA;;AAAAA","names":["defaultParserMap","application/json","multipart/form-data","*/*","text/event-stream","sortByEntry","a","b","defaultParamSerializer","params","Object","entries","sort","map","key","value","encodeURIComponent","join","buildUrl","options","url","baseURL","resolver","resolve","paramsSerializer","absoluteUrl","moreUrl","remainingParams","path","split","segment","startsWith","substr","search","concatChar","includes","isBlobSupported","Blob","defaultValidateStatus","status","compatMap","arraybuffer","document","ThwackResponse","constructor","response","statusText","data","headers","this","ok","fromEntries","ThwackEvent","type","payload","defaultPrevented","propagationStopped","_payload","preventDefault","stopPropagation","ThwackResponseBaseEvent","thwackResponse","super","defineProperty","get","ThwackDataEvent","ThwackErrorEvent","ThwackResponseError","Error","message","name","returnResponse","responseType","responseParserMap","contentTypeHeader","compatResponseParserType","responseParserType","parserMap","contentType","contentTypeTrimmed","trim","contentTypeMajor","mergedParserMap","body","fetchResponseData","errorEvent","_this","dispatchEvent","call","validateStatus","dataEvent","_exit","ThwackResponseEvent","ThwackRequestEvent","deepSpreadOptions","createOptions","keys","reduce","combined","[object Object]","obj","prototype","toString","combineOptions","instance","defaults","request","requestOptions","combinedOptions","requestEvent","fetch","rest","JSON","stringify","fetchUrl","fetchOptions","length","method","fetcher","responseEvent","resolveOptionsFromArgs","args","createThwack","parent","bind","forEach","methodKey","toLowerCase","getUri","create","depth","listeners","error","addEventListener","callback","push","removeEventListener","filter","listener","event","promise","then","undefined","finally","Promise","mainInstance","maxDepth","accept","buildURL","all","promises","spread","results","window","location","core","origin","pathname"],"sources":["/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/defaults.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/utils/buildUrl/sortByEntry.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/utils/buildUrl/defaultParamsSerializer.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/utils/buildUrl/index.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/utils/buildUrl/substituteParamsInPath.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/utils/buildUrl/joinSearch.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/utils/computeContentType.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/utils/defaultValidateStatus.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/utils/compatParser.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/ThwackResponse.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/ThwackEvents/ThwackEvent.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/ThwackEvents/ThwackResponseBaseEvent.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/ThwackEvents/ThwackDataEvent.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/ThwackEvents/ThwackErrorEvent.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/ThwackErrors/ThwackResponseError.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/returnResponse.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/utils/computeParser.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/ThwackEvents/ThwackResponseEvent.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/ThwackEvents/ThwackRequestEvent.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/utils/deepSpreadOptions.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/utils/combineOptions.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/request.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/fetcher.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/utils/resolveOptionsFromArgs.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/Thwack.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/events.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/core/index.js","/Users/vitto/Documents/PERSONAL/intern/meyd.it/client/node_modules/thwack/src/default/index.js"],"sourcesContent":["export const APPLICATION_JSON = 'application/json';\nexport const CONTENT_TYPE = 'content-type';\n\nexport const defaultOptions = {\n  maxDepth: 5,\n  params: {},\n  headers: {\n    accept: `${APPLICATION_JSON}, text/plain, */*`,\n  },\n  buildURL: 'complete',\n};\n\nexport const defaultParserMap = {\n  [APPLICATION_JSON]: 'json',\n  'multipart/form-data': 'formData',\n  '*/*': 'text',\n  'text/event-stream': 'stream',\n};\n","// take a pair from Array.entries (key/value) and sort the key alphabetically\nconst sortByEntry = ([a], [b]) => {\n  if (a < b) {\n    return -1;\n  }\n  if (a > b) {\n    return 1;\n  }\n  return 0;\n};\n\nexport default sortByEntry;\n","import sortByEntry from './sortByEntry';\n\nexport const defaultParamSerializer = (params) =>\n  Object.entries(params)\n    .sort(sortByEntry)\n    .map(\n      ([key, value]) =>\n        `${encodeURIComponent(key)}=${encodeURIComponent(value)}`\n    )\n    .join('&');\n","import { resolve } from '@thwack/resolve';\nimport joinSearch from './joinSearch';\nimport { defaultParamSerializer } from './defaultParamsSerializer';\nimport { substituteParamsInPath } from './substituteParamsInPath';\n\nconst buildUrl = (options) => {\n  const {\n    url,\n    baseURL = url, // resolver throws if baseURL is empty (per spec)\n    params,\n    resolver = resolve,\n    paramsSerializer = defaultParamSerializer,\n  } = options;\n\n  // resolve url=foo base=http://ex.co => http://ex.co/foo\n  const absoluteUrl = resolver(url, baseURL);\n\n  // convert http://ex.co/foo:id => http://ex.co/foo/123\n  const [moreUrl, remainingParams] = substituteParamsInPath(\n    absoluteUrl,\n    params\n  );\n\n  // url=http://ex.co/foo/123 params={y:2, x:1} => http://ex.co/foo/123?x=1&y=2\n  const search = paramsSerializer(remainingParams);\n  return joinSearch(moreUrl, search);\n};\n\nexport default buildUrl;\n","export const substituteParamsInPath = (path, params) => {\n  // substitute any :name in the path for params.name\n  const remainingParams = { ...params };\n  const newPath = path\n    .split('/')\n    .map((segment) => {\n      if (segment.startsWith(':')) {\n        const key = segment.substr(1);\n        const value = remainingParams[key];\n        delete remainingParams[key];\n        return encodeURIComponent(value);\n      }\n      return segment;\n    })\n    .join('/');\n\n  return [newPath, remainingParams];\n};\n","const joinSearch = (url, search) => {\n  const concatChar = url.includes('?') ? '&' : '?';\n  return `${url}${search ? concatChar : ''}${search}`;\n};\n\nexport default joinSearch;\n","import { APPLICATION_JSON } from '../defaults';\n\n// Only test for instanceodf Blob if running on a system that supports them.\n// Blobs are not supported on NodeJS, for example.\nconst isBlobSupported = typeof Blob !== 'undefined';\n\n// If the data is a Blob, grab its type\n// else default to 'application/json'\nconst computeContentType = (data) =>\n  isBlobSupported && data instanceof Blob ? data.type : APPLICATION_JSON;\n\nexport default computeContentType;\n","export const defaultValidateStatus = (status) => status >= 200 && status < 300;\n","// Axios options for options.responseType are:\n// 'arraybuffer', 'document', 'json', 'text', 'stream', 'blob'\n\nconst compatMap = {\n  arraybuffer: 'arrayBuffer',\n  document: 'formData',\n};\n\nconst compatParser = (responseParserType) =>\n  compatMap[responseParserType] || responseParserType;\n\nexport default compatParser;\n","import { defaultValidateStatus } from './utils/defaultValidateStatus';\n\nexport default class ThwackResponse {\n  constructor(response, options) {\n    const {\n      status = 200,\n      statusText = `Status ${status}`,\n      data,\n      headers = {},\n    } = response;\n    this.status = status;\n    this.statusText = statusText;\n    this.ok = defaultValidateStatus(status);\n    this.data = data;\n    this.headers =\n      typeof headers.entries === 'function' // TODO why can't I do `headers instanceof Headers`?\n        ? Object.fromEntries(headers.entries())\n        : headers;\n    this.options = options;\n    this.response = response;\n  }\n}\n","// TODO make this extend CustomEvent and use EventTarget some day? Maybe?\nexport default class ThwackEvent {\n  constructor(type, payload) {\n    this.type = type;\n    this.defaultPrevented = false;\n    this.propagationStopped = false;\n    this._payload = payload;\n  }\n\n  preventDefault() {\n    this.defaultPrevented = true;\n  }\n\n  stopPropagation() {\n    this.propagationStopped = true;\n  }\n}\n","import ThwackEvent from './ThwackEvent';\n\nexport default class ThwackResponseBaseEvent extends ThwackEvent {\n  constructor(type, thwackResponse) {\n    super(type, thwackResponse);\n\n    Object.defineProperty(this, 'thwackResponse', {\n      get() {\n        return this._payload;\n      },\n    });\n  }\n}\n","import ThwackResponseBaseEvent from './ThwackResponseBaseEvent';\n\nexport default class ThwackDataEvent extends ThwackResponseBaseEvent {\n  constructor(thwackResponse) {\n    super('data', thwackResponse);\n  }\n}\n","import ThwackResponseBaseEvent from './ThwackResponseBaseEvent';\n\nexport default class ThwackErrorEvent extends ThwackResponseBaseEvent {\n  constructor(thwackResponse) {\n    super('error', thwackResponse);\n  }\n}\n","const thwackResponseError = 'ThwackResponseError';\n\nclass ThwackResponseError extends Error {\n  constructor(thwackResponse) {\n    super(thwackResponseError);\n    this.message = `Status ${thwackResponse.status}`;\n    this.name = thwackResponseError;\n    this.thwackResponse = thwackResponse;\n  }\n}\n\nexport default ThwackResponseError;\n","import { CONTENT_TYPE } from './defaults';\nimport { defaultValidateStatus } from './utils/defaultValidateStatus';\nimport computeParser from './utils/computeParser';\nimport compatParser from './utils/compatParser';\nimport ThwackResponse from './ThwackResponse';\nimport ThwackDataEvent from './ThwackEvents/ThwackDataEvent';\nimport ThwackErrorEvent from './ThwackEvents/ThwackErrorEvent';\nimport ThwackResponseError from './ThwackErrors/ThwackResponseError';\n\nasync function fetchResponseData(thwackResponse) {\n  const { response, options } = thwackResponse;\n\n  // if `response` is NOT a instance of `Response` then it is \"synthetic\"\n  // (i.e. created from a mock source) so don't stream and parse the body.\n  // Instead, return the synthetic `thwackResponse.data` field.\n  // Note: React Native does NOT expose `body` so stream is unsupported\n  // see https://github.com/facebook/react-native/issues/27741\n  const { responseType, responseParserMap } = options;\n  const contentTypeHeader = thwackResponse.headers[CONTENT_TYPE];\n  const responseParserType =\n    responseType || computeParser(contentTypeHeader, responseParserMap);\n  const compatResponseParserType = compatParser(responseParserType); // axios > thwack mapping\n\n  if (compatResponseParserType === 'stream') {\n    return response.body;\n  }\n\n  if (response[compatResponseParserType]) {\n    return response[compatResponseParserType]();\n  }\n\n  // Return the synthetic data\n  return thwackResponse.data;\n}\n\n// return either a thwackResponse (if 2xx) or throw a ThwackResponseError\nconst returnResponse = async function (thwackResponse) {\n  if (!(thwackResponse instanceof ThwackResponse)) {\n    throw new Error('Thwack: callback must return a ThwackResponse');\n  }\n  // eslint-disable-next-line no-param-reassign\n  thwackResponse.data = await fetchResponseData(thwackResponse);\n\n  const { validateStatus = defaultValidateStatus } = thwackResponse.options;\n\n  // should we\n  if (validateStatus(thwackResponse.status)) {\n    // dispatch a \"data\" event here\n    const dataEvent = new ThwackDataEvent(thwackResponse);\n    const payload = await this.dispatchEvent(dataEvent);\n    const { defaultPrevented } = dataEvent;\n    if (defaultPrevented && !payload.ok) {\n      return returnResponse.call(this, payload);\n    }\n    return payload;\n  }\n\n  // if NOT ok then throw, but first dispatch an \"error\" event\n  const errorEvent = new ThwackErrorEvent(thwackResponse);\n  const payload = await this.dispatchEvent(errorEvent);\n  const { defaultPrevented } = errorEvent;\n  if (defaultPrevented && payload.ok) {\n    return returnResponse.call(this, payload);\n  }\n\n  if (!(payload instanceof ThwackResponse)) {\n    throw new Error('Thwack: callback must return a ThwackResponse');\n  }\n\n  throw new ThwackResponseError(payload);\n};\n\nexport default returnResponse;\n","import { defaultParserMap } from '../defaults';\n\nconst computeParser = (contentTypeHeader = '', parserMap) => {\n  // grab just the actual type\n  // ex: 'application/json; charset=utf-8' => 'application/json'\n  const [contentType] = contentTypeHeader.split(';');\n  const contentTypeTrimmed = contentType.trim(); // just in case there's a misbehaving server\n\n  // grab just the \"category\"\n  // ex: 'application/json' => 'application'\n  const [contentTypeMajor] = contentTypeTrimmed.split('/');\n  const mergedParserMap = { ...defaultParserMap, ...parserMap };\n\n  const parserType =\n    mergedParserMap[contentTypeTrimmed] || // ex: 'application/json'\n    mergedParserMap[`${contentTypeMajor}/*`] || // ex: 'application/*'\n    mergedParserMap['*/*']; // default to parser type specified by '*/*'\n\n  return parserType;\n};\n\nexport default computeParser;\n","import ThwackResponseBaseEvent from './ThwackResponseBaseEvent';\n\nexport default class ThwackResponseEvent extends ThwackResponseBaseEvent {\n  constructor(thwackResponse) {\n    super('response', thwackResponse);\n  }\n}\n","import ThwackEvent from './ThwackEvent';\n\nexport default class ThwackRequestEvent extends ThwackEvent {\n  constructor(options) {\n    super('request', options);\n\n    Object.defineProperty(this, 'options', {\n      get() {\n        return this._payload;\n      },\n    });\n  }\n}\n","const isObject = (obj) =>\n  Object.prototype.toString.call(obj) === '[object Object]';\n\nconst deepSpreadOptions = (createOptions = {}, options = {}) => {\n  const allKeys = Object.keys({\n    ...createOptions,\n    ...options,\n  });\n\n  return allKeys.reduce((combined, key) => {\n    // TODO use nullish coalescing when supported by microbundle, like this:\n    // const value = options[key] ?? createOptions[key];\n    const value = options[key] != null ? options[key] : createOptions[key];\n\n    return {\n      ...combined,\n      [key]: isObject(value)\n        ? deepSpreadOptions(createOptions[key], options[key])\n        : value,\n    };\n  }, {});\n};\n\nexport default deepSpreadOptions;\n","import deepSpreadOptions from './deepSpreadOptions';\n\nconst combineOptions = (instance, options) =>\n  deepSpreadOptions(instance.defaults, options);\n\nexport default combineOptions;\n","import fetcher from './fetcher';\nimport returnResponse from './returnResponse';\nimport ThwackResponseEvent from './ThwackEvents/ThwackResponseEvent';\nimport ThwackRequestEvent from './ThwackEvents/ThwackRequestEvent';\nimport combineOptions from './utils/combineOptions';\nimport ThwackResponse from './ThwackResponse';\n\nconst request = async function (requestOptions) {\n  // Compute the options to use\n  // 1. combine options from:\n  //  a. passed `requestOptions`\n  //  b. `this.defaults` (i.e. when instance was created)\n  //  c. and all parents' `this.defaults`\n  // 2. dispatch those options to any listeners (they _may_ change them)\n  //    by returning a new options as payload\n  // 3. set options to the returned payload unless...\n  //    payload is a ThwackResponse, in which skip calling fetcher\n  const { maxDepth, ...combinedOptions } = combineOptions(this, requestOptions);\n\n  // before we do anything, dispatch a \"request\" event with the combined options\n  // one of the callbacks may optionally return a ThwackResponse (if preventDefault)\n  // or possibly alter the options\n  const requestEvent = new ThwackRequestEvent(combinedOptions);\n  const payload = await this.dispatchEvent(requestEvent);\n  const { defaultPrevented } = requestEvent;\n  if (defaultPrevented) {\n    // bail out with a ThwackResponse (will be checked in returnResponse)\n    return returnResponse.call(this, payload);\n  }\n\n  // assume payload is options (fetcher will check for sure)\n  const options = payload;\n  const response = await fetcher(options);\n  const responseEvent = new ThwackResponseEvent(\n    new ThwackResponse(response, options)\n  );\n\n  // no need to check preventDefault here as both the default and the alternative\n  // would both lead to returnResponse\n  return returnResponse.call(this, await this.dispatchEvent(responseEvent));\n};\n\nexport default request;\n","import { APPLICATION_JSON, CONTENT_TYPE } from './defaults';\nimport buildUrl from './utils/buildUrl';\nimport computeContentType from './utils/computeContentType';\n\nconst fetcher = async function (options) {\n  const {\n    url,\n    baseURL,\n    fetch,\n    data,\n    headers,\n    params,\n    responseParserMap,\n    responseType,\n    maxDepth, // don't pass to fetch\n    ...rest\n  } = options;\n\n  if (!fetch) {\n    throw new Error(\n      'Thwack: Invalid options object during request. Check your event callbacks.'\n    );\n  }\n\n  // choose content-type based on the type of data\n  if (data && !headers[CONTENT_TYPE]) {\n    headers[CONTENT_TYPE] = computeContentType(data);\n  }\n  const body =\n    data && headers[CONTENT_TYPE] === APPLICATION_JSON\n      ? JSON.stringify(data)\n      : data;\n\n  const fetchUrl = buildUrl({ ...options, url, baseURL });\n\n  const fetchOptions = {\n    ...(Object.keys(headers).length !== 0 && { headers }), // add if not empty object\n    ...(!!body && { body, method: 'POST' }), // if body not empty add it and default method to POST\n    ...rest,\n  };\n\n  return fetch(fetchUrl, fetchOptions);\n};\n\nexport default fetcher;\n","const resolveOptionsFromArgs = (args) =>\n  args.length > 1 // url, options?\n    ? { ...args[1], url: args[0] } // yes, use a combined options\n    : args[0]; // no, use the original options\n\nexport default resolveOptionsFromArgs;\n","import request from './request';\nimport combineOptions from './utils/combineOptions';\nimport buildUrl from './utils/buildUrl';\nimport resolveOptionsFromArgs from './utils/resolveOptionsFromArgs';\nimport { events } from './events';\n\nexport const createThwack = function (defaults, parent) {\n  // createThwack returns a function that accepts (url, options)\n  //  or just (options), but calls request with just (options)\n  const instance = (...args) => instance.request(resolveOptionsFromArgs(args));\n\n  instance.defaults = defaults;\n\n  instance.request = request.bind(instance);\n\n  // Create convenience methods on this instance\n  ['GET', 'DELETE', 'HEAD'].forEach((method) => {\n    const methodKey = method.toLowerCase();\n    instance[methodKey] = (url, options) =>\n      instance.request({ ...options, method, url });\n  });\n\n  ['PUT', 'POST', 'PATCH'].forEach((method) => {\n    const methodKey = method.toLowerCase();\n    instance[methodKey] = (url, data, options) =>\n      instance.request({ ...options, method, url, data });\n  });\n\n  instance.getUri = (options) => {\n    const combinedOptions = combineOptions(instance, options);\n    return buildUrl(combinedOptions);\n  };\n\n  instance.create = (options) => {\n    const createOptions = combineOptions(instance, options);\n    return createThwack(createOptions, instance);\n  };\n\n  events(instance, parent);\n\n  return instance;\n};\n","/* eslint-disable no-param-reassign */\n\nexport const events = (instance, parent) => {\n  // private properties\n  let depth = 0;\n  const listeners = {\n    request: [],\n    response: [],\n    data: [],\n    error: [],\n  };\n\n  instance.addEventListener = (type, callback) => {\n    listeners[type].push(callback);\n  };\n\n  instance.removeEventListener = (type, callback) => {\n    listeners[type] = listeners[type].filter(\n      (listener) => listener !== callback\n    );\n  };\n\n  instance.dispatchEvent = (event) =>\n    listeners[event.type]\n      .reduce(\n        (promise, listener) =>\n          promise\n            // call our next callback (unless propagationStopped was called)\n            .then(\n              // TODO use nullish coalescing when supported by microbundle, like this:\n              // () => !event.propagationStopped ?? listener(event)\n              () => {\n                depth += 1;\n                if (depth >= 5) {\n                  throw new Error('Thwack: maximum request depth reached');\n                }\n                return event.propagationStopped ? undefined : listener(event);\n              }\n            )\n            .finally(() => {\n              depth -= 1;\n            })\n            // if callback returned payload (or a promise that resolves to payload)\n            // then set the payload in the event object\n            .then((payload) => {\n              if (payload !== undefined) {\n                event._payload = payload;\n              }\n            }),\n        // start with the promise from the parent or a resolved promise if no parent\n        parent ? parent.dispatchEvent(event) : Promise.resolve()\n      )\n      // return the event payload to the caller\n      .then(() => event._payload);\n};\n","import { createThwack } from './Thwack';\nimport ThwackResponseError from './ThwackErrors/ThwackResponseError';\nimport ThwackResponse from './ThwackResponse';\nimport { defaultOptions } from './defaults';\n\n// expose a single Thwack instance using top level defaults\nconst mainInstance = createThwack(defaultOptions);\n\n// export these \"static\" methods only on the main instance\nmainInstance.ThwackResponseError = ThwackResponseError;\nmainInstance.ThwackResponse = ThwackResponse;\nmainInstance.all = (promises) => Promise.all(promises);\nmainInstance.spread = (callback) => (results) => callback(...results);\n\nexport default mainInstance;\n","// This is the file used when you import from 'thwack'\nimport core from '../core';\n\nif (typeof window !== 'undefined') {\n  const { fetch, location } = window;\n  core.defaults.fetch = fetch;\n\n  /* istanbul ignore next */\n  if (location) {\n    const { origin, pathname } = location;\n    core.defaults.baseURL = `${origin}${pathname}`;\n  }\n}\n\nexport default core;\n"]},"metadata":{},"sourceType":"module"}